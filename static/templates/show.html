<div class="row show">
	<div class="col-xs-12">
		<div class="page-header">
			<h1>{{ show.name }} <small>{{ show.genre }}</small></h1>
		</div>
	</div>
</div>

<div class="row show hidden-lg hidden-md">
	<div class="col-xs-12 col-lg-6 col-lg-offset-3">
		<div ng-if="seasons.length > 0" class="card controls">
			<p class="link" ng-click="track(show)" ng-if="!tracked && tracked !== null">Add to tracked shows</p>
			<p class="link" ng-click="untrack(show)" ng-if="tracked && tracked !== null">Do not track anymore</p>
			<ul class="list list-inline hidden-xs">
				<li>
					<label class="checkbox">
						<input type="checkbox" ng-model="oneAtATime" ng-change="SaveOneAtATime(oneAtATime)">
						Open only one at a time
					</label>
				</li>
				<li>
					<button class="btn btn-default btn-sm" ng-click="openAll(true)">Show all</button>
				</li>
				<li>
					<button class="btn btn-default btn-sm" ng-click="openAll(false)">Close all</button>
				</li>
				<li ng-if="loggedin" class="pull-right">
					<label class="checkbox">
						<input type="checkbox" ng-model="showWatched" ng-change="SaveShowWatched(showWatched)">
						Show watched episodes
					</label>
				</li>
			</ul>
			<ul class="list list-unstyled visible-xs">
				<li>
					<label class="checkbox">
						<input type="checkbox" ng-model="oneAtATime" ng-change="SaveOneAtATime(oneAtATime)">
						Open only one at a time
					</label>
				</li>
				<li ng-if="loggedin">
					<label class="checkbox">
						<input type="checkbox" ng-model="showWatched" ng-change="SaveShowWatched(showWatched)">
						Show watched episodes
					</label>
				</li>
			</ul>
		</div>
		<p ng-if="seasons.length === 0">This show has no episodes.</p>
		<div class="card">
			<accordion close-others="oneAtATime" ng-if="seasons.length > 0">
			<accordion-group ng-repeat="season in seasons" is-open="season.status" ng-if="showSeasons(season, showWatched)">
				<accordion-heading>
					Season {{ season.season }} <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': season.status, 'glyphicon-chevron-right': !season.status}"></i>
				</accordion-heading>
				<div class="table-responsive">
					<table class="table table-striped table-hover table-condensed">
						<thead>
							<tr>
								<th>Nr</th>
								<th>Title</th>
								<th class="hidden-xs">Airdate</th>
								<th ng-if="tracked">Watched</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="ep in season.episodes | orderBy: 'episode'" ng-class="{success: lessThanAWeek(ep.airdate)}" ng-if="showWatched || !ep.watched">
								<td>{{ ep.episode }}</td>
								<td>{{ ep.title }}</td>
								<td class="hidden-xs">{{ ep.airdate | date: "yyyy-MM-dd" }}</td>
								<td ng-if="tracked && ep.watched" class="watched"><span class="glyphicon glyphicon-ok text-success" ng-click="notWatchedEpisode(ep)"></span></td>
								<td ng-if="tracked && !ep.watched" class="watched"><span class="glyphicon glyphicon-remove text-danger" ng-click="watchedEpisode(ep)"></span></td>
							</tr>
						</tbody>
					</table>
				</div>
			</accordion-group>
		</accordion>
		</div>
	</div>
</div>

<div class="row visible-lg visible-md" ng-if="loggedin">
	<div class="col-md-12">
		<div ng-if="seasons.length > 0" class="card controls">
			<ul class="list list-inline">
				<li>
					<label class="checkbox">
						<input type="checkbox" ng-model="showWatched" ng-change="SaveShowWatched(showWatched)">
						Show watched episodes
					</label>
				</li>
				<li class="link" ng-click="track(show)" ng-if="!tracked && tracked !== null"><span class="glyphicon glyphicon-plus text-success"></span> Add to tracked shows</li>
				<li class="link" ng-click="untrack(show)" ng-if="tracked && tracked !== null"><span class="glyphicon glyphicon-minus text-danger"></span> Do not track anymore</li>
			</ul>
		</div>
	</div>
</div>
<div class="row visible-lg visible-md shows" ng-show="seasons | countUnwatched: showWatched">
	<div class="col-md-12">
		<tabset vertical="true" type="pills">
			<tab ng-repeat="season in seasons" ng-if="showSeasons(season, showWatched)" active="season.status">
				<tab-heading>
					Season {{ season.season }} <span class="glyphicon glyphicon-chevron-right pull-right"></span>
				</tab-heading>
				<h2>Season {{ season.season }}</h2>
				<table class="table table-striped table-hover table-condensed">
					<thead>
						<tr>
							<th>Nr</th>
							<th>Title</th>
							<th>Airdate</th>
							<td ng-if="tracked">Watched</td>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="ep in season.episodes | orderBy: 'episode'" ng-class="{success: lessThanAWeek(ep.airdate)}" ng-if="showWatched || !ep.watched">
							<td>{{ ep.episode }}</td>
							<td>{{ ep.title }}</td>
							<td>{{ ep.airdate | date: "yyyy-MM-dd" }}</td>
							<td ng-if="tracked && ep.watched" class="watched"><span class="glyphicon glyphicon-ok text-success" ng-click="notWatchedEpisode(ep)"></span></td>
							<td ng-if="tracked && !ep.watched" class="watched"><span class="glyphicon glyphicon-remove text-danger" ng-click="watchedEpisode(ep)"></span></td>
						</tr>
					</tbody>
				</table>
			</tab>
		</tabset>
	</div>
</div>
<div class="row visible-lg visible-md shows" ng-show="!(seasons | countUnwatched: showWatched)">
	<div class="col-md-12">
		<div class="card">
			<p>No episodes to display.</p>
		</div>
	</div>
</div>
<div class="row">
	<div class="col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3">


		<div class="card info">
			<h2>{{ show.name }}</h2>
			<ul class="list-unstyled">
				<li><span ng-if="omdb.imdbRating">Runtime: <strong>{{ omdb.Runtime }}</strong>, </span>Genres: <strong>{{ show.genre }}</strong></li>
				<li ng-if="omdb.imdbRating">Rating: <strong>{{ omdb.imdbRating }}</strong>/10 at <a ng-href="http://www.imdb.com/title/{{ show.imdbid }}/" target="_blank">IMDb</a></li>
				<li ng-if="omdb.imdbRating"><a ng-href="http://www.imdb.com/title/{{ show.imdbid }}/epdate?ref_=ttep_ql_4" target="_blank">List of episodes at IMDb</a></li>
				<li ng-if="omdb.imdbRating"><a ng-href="http://graphtv.kevinformatics.com/{{ show.imdbid }}" target="_blank">Graph ratings at graphTV</a></li>
			</ul>

			<div ng-show="loggedin && !show.imdbid && show.imdb_submitted !== false">
				<p>Submit IMDb id:</p>
				<form role="form" name="imdbForm" ng-submit="imdbForm.$valid && submitIMDB(imdb, show.id)" ng-show="!submittedImdbId">
					<div class="row">
						<div class="col-sm-10">
							<div class="form-group" ng-class="{'has-error': imdbForm.imdb.$error.imdb}">
								<label for="imdb" class="sr-only">IMDb id</label>
								<input type="text" class="form-control" id="imdb" name="imdb" ng-model="imdb" placeholder="e.g. http://www.imdb.com/title/tt0303461" ng-model-options="{ updateOn: 'default blur', debounce: {'default': 500, 'blur': 0} }" imdb required/>
							</div>
						</div>
						<div class="col-sm-2">
							<div class="form-group">
								<button type="submit" class="btn btn-default">Submit</button>
							</div>
						</div>
					</div>
				</form>
				<p ng-show="submittedImdbId">Thank you for submitting <em>{{ submittedImdbId }}</em>! It will be added after it has received approval.</p>
			</div>
			<div ng-show="loggedin && show.imdb_submitted === false">
				<p>The IMDb id you submitted is awaiting verification.</p>
			</div>
		</div>
	</div>
</div>

<div class="row reddit" ng-show="reddit.length>0">
	<div class="col-lg-8 col-lg-push-2">
		<h2>{{ reddit.length }} hot reddit links</h2>
		<ul class="list list-unstyled">
			<li ng-repeat="r in reddit">
				<h3><a href="{{ r.data.url }}" target="_blank" ng-class="{ 'text-success': r.data.stickied }" ng-bind-html="r.data.title"></a> <small>{{ r.data.domain }}</small></h3>
				<p><a href="//reddit.com{{ r.data.permalink }}" target="_blank">{{ r.data.num_comments }} comments</a></p>
			</li>
		</ul>
		<p class="text-center" ng-click="nextFive()">Show 5 more</p>
		<p class="text-center" ng-click="nextFive()"><span class="glyphicon glyphicon-chevron-down"></span></p>
	</div>
</div>

<loadingspinner></loadingspinner>

<div class="row reddit" ng-show="reddit.length==0 && loggedin && show.subreddit !== false">
	<div class="col-lg-6 col-lg-push-3">
		<h2>reddit</h2>
		<p ng-show="!submittedRedditText">You know the subreddit for this show? Past the link here:</p>
		<form role="form" name="subredditForm" ng-submit="subredditForm.$valid && submitSubreddit(subreddit, show.id)" ng-show="!submittedRedditText">
			<div class="row">
				<div class="col-sm-10 col-lg-11">
					<div class="form-group" ng-class="{'has-error': subredditForm.subreddit.$error.subreddit}">
						<label for="subreddit" class="sr-only">subreddit</label>
						<input type="text" class="form-control" id="subreddit" name="subreddit" ng-model="subreddit" placeholder="e.g. http://www.reddit.com/r/tvShow" ng-model-options="{ updateOn: 'default blur', debounce: {'default': 500, 'blur': 0} }" subreddit required/>
					</div>
				</div>
				<div class="col-sm-2 col-lg-1">
					<div class="form-group">
						<button type="submit" class="btn btn-default">Submit</button>
					</div>
				</div>
			</div>
		</form>
		<p ng-show="submittedRedditText">Thank you for submitting <em>{{ submittedRedditText }}</em>! It will be added after it has received approval.</p>
	</div>
</div>

<div class="row reddit" ng-show="show.subreddit === false && loggedin">
	<div class="col-lg-6 col-lg-push-3">
		<h2>reddit</h2>
		<p>The subreddit you submitted is awaiting verification.</p>
	</div>
</div>